%% load traces

% mouse #21 training
TS21D1_safety_day1=xlsread('TS21D1_optofluid_safety_day1_dff.xlsx');
TS21D1_safety_day2_shock=xlsread('TS21D1_optofluid_safety_day2_shocks_dff.xlsx');
TS21D1_safety_day2_tone=xlsread('TS21D1_optofluid_safety_day2_tones_dff.xlsx');
TS21D1_safety_day3=xlsread('TS21D1_optofluid_safety_day3_dff.xlsx');

% mouse #21 tones
TS21D1_tone_vehicle1_before=xlsread('TS21D1_optofluid_before_vehicle_tone_dff.xlsx');
TS21D1_tone_DAant=xlsread('TS21D1_optofluid_DAantagonist_tone_dff.xlsx');
TS21D1_tone_TTX=xlsread('TS21D1_optofluid_TTX_tone_dff.xlsx');

% mouse #21 shocks 
TS21D1_shock_vehicle1_before=xlsread('TS21D1_optofluid_before_vehicle_shock_dff.xlsx');
TS21D1_shock_DAant=xlsread('TS21D1_optofluid_DAantagonist_shock_dff.xlsx');
TS21D1_shock_TTX=xlsread('TS21D1_optofluid_TTX_shock_dff.xlsx');

% mouse #22 training
TS22D1_safety_day1=xlsread('TS22D1_optofluid_safety_day1_dff.xlsx');
TS22D1_safety_day2_shock=xlsread('TS22D1_optofluid_safety_day2_shocks_dff.xlsx');
TS22D1_safety_day2_tone=xlsread('TS22D1_optofluid_safety_day2_tones_dff.xlsx');
TS22D1_safety_day3=xlsread('TS22D1_optofluid_safety_day3_dff.xlsx');

% mouse #22 tones
TS22D1_tone_vehicle1_before=xlsread('TS22D1_optofluid_before_vehicle_tone_dff.xlsx');
TS22D1_tone_DAant=xlsread('TS22D1_optofluid_DAantagonist_tone_dff.xlsx');
TS22D1_tone_TTX=xlsread('TS22D1_optofluid_TTX_tone_dff.xlsx');

% mouse #22 shocks 
TS22D1_shock_vehicle1_before=xlsread('TS22D1_optofluid_before_vehicle_shock_dff.xlsx');
TS22D1_shock_DAant=xlsread('TS22D1_optofluid_DAantagonist_shock_dff.xlsx');
TS22D1_shock_TTX=xlsread('TS22D1_optofluid_TTX_shock_dff.xlsx');

% mouse #23 training
TS23D1_safety_day1=xlsread('TS23D1_optofluid_safety_day1_dff.xlsx');
TS23D1_safety_day2_shock=xlsread('TS23D1_optofluid_safety_day2_shocks_dff.xlsx');
TS23D1_safety_day2_tone=xlsread('TS23D1_optofluid_safety_day2_tones_dff.xlsx');
TS23D1_safety_day3=xlsread('TS23D1_optofluid_safety_day3_dff.xlsx');

% mouse #23 tones
TS23D1_tone_vehicle1_before=xlsread('TS23D1_optofluid_before_vehicle_tone_dff.xlsx');
TS23D1_tone_DAant=xlsread('TS23D1_optofluid_DAantagonist_tone_dff.xlsx');
TS23D1_tone_TTX=xlsread('TS23D1_optofluid_TTX_tone_dff.xlsx');

% mouse #23 shocks 
TS23D1_shock_vehicle1_before=xlsread('TS23D1_optofluid_before_vehicle_shock_dff.xlsx');
TS23D1_shock_DAant=xlsread('TS23D1_optofluid_DAantagonist_shock_dff.xlsx');
TS23D1_shock_TTX=xlsread('TS23D1_optofluid_TTX_shock_dff.xlsx');

% mouse #31 training
TS31D1_safety_day1=xlsread('TS31D1_optofluid_safety_day1_dff.xlsx');
TS31D1_safety_day2_shock=xlsread('TS31D1_optofluid_safety_day2_shocks_dff.xlsx');
TS31D1_safety_day2_tone=xlsread('TS31D1_optofluid_safety_day2_tones_dff.xlsx');
TS31D1_safety_day3=xlsread('TS31D1_optofluid_safety_day3_dff.xlsx');

% mouse #31 tones
TS31D1_tone_vehicle1_before=xlsread('TS31D1_optofluid_before_vehicle_tone_dff.xlsx');
TS31D1_tone_DAant=xlsread('TS31D1_optofluid_DAantagonist_tone_dff.xlsx');
TS31D1_tone_TTX=xlsread('TS31D1_optofluid_TTX_tone_dff.xlsx');

% mouse #31 shocks 
TS31D1_shock_vehicle1_before=xlsread('TS31D1_optofluid_before_vehicle_shock_dff.xlsx');
TS31D1_shock_DAant=xlsread('TS31D1_optofluid_DAantagonist_shock_dff.xlsx');
TS31D1_shock_TTX=xlsread('TS31D1_optofluid_TTX_shock_dff.xlsx');

% mouse #32 training
TS32D1_safety_day1=xlsread('TS32D1_optofluid_safety_day1_dff.xlsx');
TS32D1_safety_day2_shock=xlsread('TS32D1_optofluid_safety_day2_shocks_dff.xlsx');
TS32D1_safety_day2_tone=xlsread('TS32D1_optofluid_safety_day2_tones_dff.xlsx');
TS32D1_safety_day3=xlsread('TS32D1_optofluid_safety_day3_dff.xlsx');

% mouse #32 tones
TS32D1_tone_vehicle1_before=xlsread('TS32D1_optofluid_before_vehicle_tone_dff.xlsx');
TS32D1_tone_DAant=xlsread('TS32D1_optofluid_DAantagonist_tone_dff.xlsx');
TS32D1_tone_TTX=xlsread('TS32D1_optofluid_TTX_tone_dff.xlsx');

% mouse #32 shocks 
TS32D1_shock_vehicle1_before=xlsread('TS32D1_optofluid_before_vehicle_shock_dff.xlsx');
TS32D1_shock_DAant=xlsread('TS32D1_optofluid_DAantagonist_shock_dff.xlsx');
TS32D1_shock_TTX=xlsread('TS32D1_optofluid_TTX_shock_dff.xlsx');

%% time
ToneTime=TS32D1_safety_day1(5:5889,5);
ShockTime=TS32D1_safety_day1(5:1465,12);
cells_to_15min=89401;
cells_to_1min=5889;
cells_to_3min=17686;


%% isolate tones

% #21 training
TS21D1_safety_day1_tones=TS21D1_safety_day1(5:5889,6:9);
TS21D1_safety_day2_tones=TS21D1_safety_day2_tone(5:5889,6:9);
TS21D1_safety_day3_tones=TS21D1_safety_day3(5:5889,6:9);

% #21 vehicle before infusion 
TS21D1_tone_vehicle1_b=TS21D1_tone_vehicle1_before(5:5889,7:16);

% #21 after infusion 
TS21D1_tone_vehicle1_a=TS21D1_tone_vehicle1_after(5:5889,7:16);
TS21D1_tone_DAant_a=TS21D1_tone_DAant(5:5889,7:16);
TS21D1_tone_TTX_a=TS21D1_tone_TTX(5:5889,7:16);

% #22 training
TS22D1_safety_day1_tones=TS22D1_safety_day1(5:5889,6:9);
TS22D1_safety_day2_tones=TS22D1_safety_day2_tone(5:5889,6:9);
TS22D1_safety_day3_tones=TS22D1_safety_day3(5:5889,6:9);

% #22 vehicle before infusion 
TS22D1_tone_vehicle1_b=TS22D1_tone_vehicle1_before(5:5889,7:16);
TS22D1_tone_DAant_a=TS22D1_tone_DAant(5:5889,7:16);
TS22D1_tone_TTX_a=TS22D1_tone_TTX(5:5889,7:16);

% #23 training
TS23D1_safety_day1_tones=TS23D1_safety_day1(5:5889,6:9);
TS23D1_safety_day2_tones=TS23D1_safety_day2_tone(5:5889,6:9);
TS23D1_safety_day3_tones=TS23D1_safety_day3(5:5889,6:9);

% #23 vehicle before infusion 
TS23D1_tone_vehicle1_b=TS23D1_tone_vehicle1_before(5:5889,7:16);
TS23D1_tone_DAant_a=TS23D1_tone_DAant(5:5889,7:16);
TS23D1_tone_TTX_a=TS23D1_tone_TTX(5:5889,7:16);

% #31 training
TS31D1_safety_day1_tones=TS31D1_safety_day1(5:5889,6:9);
TS31D1_safety_day2_tones=TS31D1_safety_day2_tone(5:5889,6:9);
TS31D1_safety_day3_tones=TS31D1_safety_day3(5:5889,6:9);

% #31 vehicle before infusion 
TS31D1_tone_vehicle1_b=TS31D1_tone_vehicle1_before(5:5889,7:16);
TS31D1_tone_DAant_a=TS31D1_tone_DAant(5:5889,7:16);
TS31D1_tone_TTX_a=TS31D1_tone_TTX(5:5889,7:16);

% #32 training
TS32D1_safety_day1_tones=TS32D1_safety_day1(5:5889,6:9);
TS32D1_safety_day2_tones=TS32D1_safety_day2_tone(5:5889,6:9);
TS32D1_safety_day3_tones=TS32D1_safety_day3(5:5889,6:9);

% #32 vehicle before infusion 
TS32D1_tone_vehicle1_b=TS32D1_tone_vehicle1_before(5:5889,7:16);
TS32D1_tone_DAant_a=TS32D1_tone_DAant(5:5889,7:16);
TS32D1_tone_TTX_a=TS32D1_tone_TTX(5:5889,7:16);

%% isolate shocks

% #21 training
TS21D1_safety_day1_shocks=TS21D1_safety_day1(5:1465,13:16);
TS21D1_safety_day2_shocks=TS21D1_safety_day2_shock(5:1465,13:16);
TS21D1_safety_day3_shocks=TS21D1_safety_day3(5:1465,13:16);

% #21 vehicle before infusion 
TS21D1_shock_vehicle1_b=TS21D1_shock_vehicle1_before(5:1465,13:16);
TS21D1_shock_DAant_a=TS21D1_shock_DAant(5:1465,13:16);
TS21D1_shock_TTX_a=TS21D1_shock_TTX(5:1465,13:16);

% #22 training
TS22D1_safety_day1_shocks=TS22D1_safety_day1(5:1465,13:16);
TS22D1_safety_day2_shocks=TS22D1_safety_day2_shock(5:1465,13:16);
TS22D1_safety_day3_shocks=TS22D1_safety_day3(5:1465,13:16);

% #22 vehicle before infusion 
TS22D1_shock_vehicle1_b=TS22D1_shock_vehicle1_before(5:1465,13:16);
TS22D1_shock_DAant_a=TS22D1_shock_DAant(5:1465,13:16);
TS22D1_shock_TTX_a=TS22D1_shock_TTX(5:1465,13:16);

% #23 training
TS23D1_safety_day1_shocks=TS23D1_safety_day1(5:1465,13:16);
TS23D1_safety_day2_shocks=TS23D1_safety_day2_shock(5:1465,13:16);
TS23D1_safety_day3_shocks=TS23D1_safety_day3(5:1465,13:16);

% #23 vehicle before infusion 
TS23D1_shock_vehicle1_b=TS23D1_shock_vehicle1_before(5:1465,13:16);
TS23D1_shock_DAant_a=TS23D1_shock_DAant(5:1465,13:16);
TS23D1_shock_TTX_a=TS23D1_shock_TTX(5:1465,13:16);
TS23D1_shock_SCH23390_a=TS23D1_shock_SCH23390(5:1465,13:16);
TS23D1_shock_sulpiride_a=TS23D1_shock_sulpiride(5:1465,13:16);
TS23D1_shock_GLUant_a=TS23D1_shock_GLUant(5:1465,13:16);

% #31 training
TS31D1_safety_day1_shocks=TS31D1_safety_day1(5:1465,13:16);
TS31D1_safety_day2_shocks=TS31D1_safety_day2_shock(5:1465,13:16);
TS31D1_safety_day3_shocks=TS31D1_safety_day3(5:1465,13:16);

% #31 vehicle before infusion 
TS31D1_shock_vehicle1_b=TS31D1_shock_vehicle1_before(5:1465,13:16);
TS31D1_shock_DAant_a=TS31D1_shock_DAant(5:1465,13:16);
TS31D1_shock_TTX_a=TS31D1_shock_TTX(5:1465,13:16);

% #32 training
TS32D1_safety_day1_shocks=TS21D1_safety_day1(5:1465,13:16);
TS32D1_safety_day2_shocks=TS21D1_safety_day2_shock(5:1465,13:16);
TS32D1_safety_day3_shocks=TS21D1_safety_day3(5:1465,13:16);

% #32 vehicle before infusion 
TS32D1_shock_vehicle1_b=TS21D1_shock_vehicle1_before(5:1465,13:16);
TS32D1_shock_DAant_a=TS32D1_shock_DAant(5:1465,13:16);
TS32D1_shock_TTX_a=TS32D1_shock_TTX(5:1465,13:16);

%% convert tones to zscore
% normal zscore

% #21 training
zTS21D1_safety_day1_tones=C4_Convert_tones_to_Zscore(ToneTime,TS21D1_safety_day1_tones);
title('TS21 Day 1 Safety Tones');
zTS21D1_safety_day2_tones=C4_Convert_tones_to_Zscore(ToneTime,TS21D1_safety_day2_tones);
title('TS21 Day 2 Safety Tones');
zTS21D1_safety_day3_tones=C4_Convert_tones_to_Zscore(ToneTime,TS21D1_safety_day3_tones);
title('TS21 Day 3 Safety Tones');

% #21 before vehicle
zTS21D1_tone_vehicle1_b=C4_Convert_tones_to_Zscore(ToneTime,TS21D1_tone_vehicle1_b);
title('TS21 Tone before vehicle 1');
zTS21D1_tone_DAant=C4_Convert_tones_to_Zscore(ToneTime,TS21D1_tone_DAant_a);
title('TS21 Tone after SCH23390 + Sulpiride');
zTS21D1_tone_TTX=C4_Convert_tones_to_Zscore(ToneTime,TS21D1_tone_TTX_a);
title('TS21 Tone after TTX');

% #22 training
zTS22D1_safety_day1_tones=C4_Convert_tones_to_Zscore(ToneTime,TS22D1_safety_day1_tones);
title('TS22 Day 1 Safety Tones');
zTS22D1_safety_day2_tones=C4_Convert_tones_to_Zscore(ToneTime,TS22D1_safety_day2_tones);
title('TS22 Day 2 Safety Tones');
zTS22D1_safety_day3_tones=C4_Convert_tones_to_Zscore(ToneTime,TS22D1_safety_day3_tones);
title('TS22 Day 3 Safety Tones');

% #22 before vehicle
zTS22D1_tone_vehicle1_b=C4_Convert_tones_to_Zscore(ToneTime,TS22D1_tone_vehicle1_b);
title('TS22 Tone before vehicle 1');
zTS22D1_tone_DAant=C4_Convert_tones_to_Zscore(ToneTime,TS22D1_tone_DAant_a);
title('TS22 Tone after SCH23390 + Sulpiride');
zTS22D1_tone_TTX=C4_Convert_tones_to_Zscore(ToneTime,TS22D1_tone_TTX_a);
title('TS22 Tone after TTX');

% #23 training
zTS23D1_safety_day1_tones=C4_Convert_tones_to_Zscore(ToneTime,TS23D1_safety_day1_tones);
title('TS23 Day 1 Safety Tones');
zTS23D1_safety_day2_tones=C4_Convert_tones_to_Zscore(ToneTime,TS23D1_safety_day2_tones);
title('TS23 Day 2 Safety Tones');
zTS23D1_safety_day3_tones=C4_Convert_tones_to_Zscore(ToneTime,TS23D1_safety_day3_tones);
title('TS23 Day 3 Safety Tones');

% #23 before vehicle
zTS23D1_tone_vehicle1_b=C4_Convert_tones_to_Zscore(ToneTime,TS23D1_tone_vehicle1_b);
title('TS23 Tone before vehicle 1');
zTS23D1_tone_DAant=C4_Convert_tones_to_Zscore(ToneTime,TS23D1_tone_DAant_a);
title('TS23 Tone after SCH23390 + Sulpiride');
zTS23D1_tone_TTX=C4_Convert_tones_to_Zscore(ToneTime,TS23D1_tone_TTX_a);
title('TS23 Tone after TTX');

% #31 training
zTS31D1_safety_day1_tones=C4_Convert_tones_to_Zscore(ToneTime,TS31D1_safety_day1_tones);
title('TS31 Tone Day 1 Safety Tones');
zTS31D1_safety_day2_tones=C4_Convert_tones_to_Zscore(ToneTime,TS31D1_safety_day2_tones);
title('TS31 Tone Day 2 Safety Tones');
zTS31D1_safety_day3_tones=C4_Convert_tones_to_Zscore(ToneTime,TS31D1_safety_day3_tones);
title('TS31 Tone Day 3 Safety Tones');

% #31 before vehicle
zTS31D1_tone_vehicle1_b=C4_Convert_tones_to_Zscore(ToneTime,TS31D1_tone_vehicle1_b);
title('TS31 Tone before vehicle 1');
zTS31D1_tone_DAant=C4_Convert_tones_to_Zscore(ToneTime,TS31D1_tone_DAant_a);
title('TS31 Tone after SCH23390 + Sulpiride');
zTS31D1_tone_TTX=C4_Convert_tones_to_Zscore(ToneTime,TS31D1_tone_TTX_a);
title('TS31 Tone after TTX');

% #32 training
zTS32D1_safety_day1_tones=C4_Convert_tones_to_Zscore(ToneTime,TS32D1_safety_day1_tones);
title('TS32 Day 1 Safety Tones');
zTS32D1_safety_day2_tones=C4_Convert_tones_to_Zscore(ToneTime,TS32D1_safety_day2_tones);
title('TS32 Day 2 Safety Tones');
zTS32D1_safety_day3_tones=C4_Convert_tones_to_Zscore(ToneTime,TS32D1_safety_day3_tones);
title('TS32 Day 3 Safety Tones');

% #32 before vehicle
zTS32D1_tone_vehicle1_b=C4_Convert_tones_to_Zscore(ToneTime,TS32D1_tone_vehicle1_b);
title('TS32 Tone before vehicle 1');
zTS32D1_tone_DAant=C4_Convert_tones_to_Zscore(ToneTime,TS32D1_tone_DAant_a);
title('TS32 Tone after SCH23390 + Sulpiride');
zTS32D1_tone_TTX=C4_Convert_tones_to_Zscore(ToneTime,TS32D1_tone_TTX_a);
title('TS32 Tone after TTX');

%% convert shocks to zscore
% normal zscore

% #21 training
zTS21D1_safety_day1_shock=C4_Convert_shock_to_Zscore(ShockTime,TS21D1_safety_day1_shocks);
title('TS21 Day 1 Safety Shocks');
zTS21D1_safety_day2_shock=C4_Convert_shock_to_Zscore(ShockTime,TS21D1_safety_day2_shocks);
title('TS21 Day 2 Safety Shocks');
zTS21D1_safety_day3_shock=C4_Convert_shock_to_Zscore(ShockTime,TS21D1_safety_day3_shocks);
title('TS21 Day 3 Safety Shocks');

% #21 before vehicle
zTS21D1_shock_vehicle1_b=C4_Convert_shock_to_Zscore(ShockTime,TS21D1_shock_vehicle1_b);
title('TS21 Shocks before vehicle 1');
zTS21D1_shock_DAant=C4_Convert_shock_to_Zscore(ShockTime,TS21D1_shock_DAant_a);
title('TS21 Shocks after SCH23390 + Sulpiride');
zTS21D1_shock_TTX=C4_Convert_shock_to_Zscore(ShockTime,TS21D1_shock_TTX_a);
title('TS21 Shocks after TTX');

% #22 training
zTS22D1_safety_day1_shock=C4_Convert_shock_to_Zscore(ShockTime,TS22D1_safety_day1_shocks);
title('TS22 Day 1 Safety Shocks');
zTS22D1_safety_day2_shock=C4_Convert_shock_to_Zscore(ShockTime,TS22D1_safety_day2_shocks);
title('TS22 Day 2 Safety Shocks');
zTS22D1_safety_day3_shock=C4_Convert_shock_to_Zscore(ShockTime,TS22D1_safety_day3_shocks);
title('TS22 Day 3 Safety Shocks');

% #22 before vehicle
zTS22D1_shock_vehicle1_b=C4_Convert_shock_to_Zscore(ShockTime,TS22D1_shock_vehicle1_b);
title('TS22 Shocks before vehicle 1');
zTS22D1_shock_DAant=C4_Convert_shock_to_Zscore(ShockTime,TS22D1_shock_DAant_a);
title('TS22 Shocks after SCH23390 + Sulpiride');
zTS22D1_shock_TTX=C4_Convert_shock_to_Zscore(ShockTime,TS22D1_shock_TTX_a);
title('TS22 Shocks after TTX');

% #23 training
zTS23D1_safety_day1_shock=C4_Convert_shock_to_Zscore(ShockTime,TS23D1_safety_day1_shocks);
title('TS23 Day 1 Safety Shocks');
zTS23D1_safety_day2_shock=C4_Convert_shock_to_Zscore(ShockTime,TS23D1_safety_day2_shocks);
title('TS23 Day 2 Safety Shocks');
zTS23D1_safety_day3_shock=C4_Convert_shock_to_Zscore(ShockTime,TS23D1_safety_day3_shocks);
title('TS23 Day 3 Safety Shocks');

% #23 before vehicle
zTS23D1_shock_vehicle1_b=C4_Convert_shock_to_Zscore(ShockTime,TS23D1_shock_vehicle1_b);
title('TS23 Shocks before vehicle 1');
zTS23D1_shock_DAant=C4_Convert_shock_to_Zscore(ShockTime,TS23D1_shock_DAant_a);
title('TS23 Shocks after SCH23390 + Sulpiride');
zTS23D1_shock_TTX=C4_Convert_shock_to_Zscore(ShockTime,TS23D1_shock_TTX_a);
title('TS23 Shocks after TTX');

% #31 training
zTS31D1_safety_day1_shock=C4_Convert_shock_to_Zscore(ShockTime,TS31D1_safety_day1_shocks);
title('TS31 Day 1 Safety Shocks');
zTS31D1_safety_day2_shock=C4_Convert_shock_to_Zscore(ShockTime,TS31D1_safety_day2_shocks);
title('TS31 Day 2 Safety Shocks');
zTS31D1_safety_day3_shock=C4_Convert_shock_to_Zscore(ShockTime,TS31D1_safety_day3_shocks);
title('TS31 Day 3 Safety Shocks');

% #31 before vehicle
zTS31D1_shock_vehicle1_b=C4_Convert_shock_to_Zscore(ShockTime,TS31D1_shock_vehicle1_b);
title('TS31 Shocks before vehicle 1');
zTS31D1_shock_DAant=C4_Convert_shock_to_Zscore(ShockTime,TS31D1_shock_DAant_a);
title('TS31 Shocks after SCH23390 + Sulpiride');
zTS31D1_shock_TTX=C4_Convert_shock_to_Zscore(ShockTime,TS31D1_shock_TTX_a);
title('TS31 Shocks after TTX');

% #32 training
zTS32D1_safety_day1_shock=C4_Convert_shock_to_Zscore(ShockTime,TS32D1_safety_day1_shocks);
title('TS32 Day 1 Safety Shocks');
zTS32D1_safety_day2_shock=C4_Convert_shock_to_Zscore(ShockTime,TS32D1_safety_day2_shocks);
title('TS32 Day 2 Safety Shocks');
zTS32D1_safety_day3_shock=C4_Convert_shock_to_Zscore(ShockTime,TS32D1_safety_day3_shocks);
title('TS32 Day 3 Safety Shocks');

% #32 before vehicle
zTS32D1_shock_vehicle1_b=C4_Convert_shock_to_Zscore(ShockTime,TS32D1_shock_vehicle1_b);
title('TS32 Shocks before vehicle 1');
zTS32D1_shock_DAant=C4_Convert_shock_to_Zscore(ShockTime,TS32D1_shock_DAant_a);
title('TS32 Shocks after SCH23390 + Sulpiride');
zTS32D1_shock_TTX=C4_Convert_shock_to_Zscore(ShockTime,TS32D1_shock_TTX_a);
title('TS32 Shocks after TTX');

%% group tones and shocks

% training
all_safety_day1_tones=[zTS21D1_safety_day1_tones,zTS22D1_safety_day1_tones,zTS23D1_safety_day1_tones,zTS31D1_safety_day1_tones,zTS32D1_safety_day1_tones];
all_safety_day2_tones=[zTS21D1_safety_day2_tones,zTS22D1_safety_day2_tones,zTS23D1_safety_day2_tones,zTS31D1_safety_day2_tones,zTS32D1_safety_day2_tones];
all_safety_day3_tones=[zTS21D1_safety_day3_tones,zTS22D1_safety_day3_tones,zTS23D1_safety_day3_tones,zTS31D1_safety_day3_tones,zTS32D1_safety_day3_tones];

all_safety_day1_shock=[zTS21D1_safety_day1_shock,zTS22D1_safety_day1_shock,zTS23D1_safety_day1_shock,zTS31D1_safety_day1_shock,zTS32D1_safety_day1_shock];
all_safety_day2_shock=[zTS21D1_safety_day2_shock,zTS22D1_safety_day2_shock,zTS23D1_safety_day2_shock,zTS31D1_safety_day2_shock,zTS32D1_safety_day2_shock];
all_safety_day3_shock=[zTS21D1_safety_day3_shock,zTS22D1_safety_day3_shock,zTS23D1_safety_day3_shock,zTS31D1_safety_day3_shock,zTS32D1_safety_day3_shock];

% tone infusions
all_before_vehicle1_tone=[zTS21D1_tone_vehicle1_b,zTS22D1_tone_vehicle1_b,zTS23D1_tone_vehicle1_b,zTS31D1_tone_vehicle1_b,zTS32D1_tone_vehicle1_b];
all_after_DAant_tone=[zTS21D1_tone_DAant,zTS22D1_tone_DAant,zTS23D1_tone_DAant,zTS31D1_tone_DAant,zTS32D1_tone_DAant];
all_after_TTX_tone=[zTS21D1_tone_TTX,zTS22D1_tone_TTX,zTS23D1_tone_TTX,zTS31D1_tone_TTX,zTS32D1_tone_TTX];

% shock infusions
all_before_vehicle1_shock=[zTS21D1_shock_vehicle1_b,zTS22D1_shock_vehicle1_b,zTS23D1_shock_vehicle1_b,zTS31D1_shock_vehicle1_b,zTS32D1_shock_vehicle1_b];
all_after_DAant_shock=[zTS21D1_shock_DAant,zTS22D1_shock_DAant,zTS23D1_shock_DAant,zTS31D1_shock_DAant,zTS32D1_shock_DAant];
all_after_TTX_shock=[zTS21D1_shock_TTX,zTS22D1_shock_TTX,zTS23D1_shock_TTX,zTS31D1_shock_TTX,zTS32D1_shock_TTX];
 
%% get AUC

% in order for this part to work you must set output of the
% "C4_Convert_tone_to_Zscore" function to "AUC_average_trace" and run section
% with the function again

% training
all_safety_day1_tones=[zTS21D1_safety_day1_tones,zTS22D1_safety_day1_tones,zTS23D1_safety_day1_tones,zTS31D1_safety_day1_tones,zTS32D1_safety_day1_tones];
all_safety_day2_tones=[zTS21D1_safety_day2_tones,zTS22D1_safety_day2_tones,zTS23D1_safety_day2_tones,zTS31D1_safety_day2_tones,zTS32D1_safety_day2_tones];
all_safety_day3_tones=[zTS21D1_safety_day3_tones,zTS22D1_safety_day3_tones,zTS23D1_safety_day3_tones,zTS31D1_safety_day3_tones,zTS32D1_safety_day3_tones];

all_safety_day1_shock=[zTS21D1_safety_day1_shock,zTS22D1_safety_day1_shock,zTS23D1_safety_day1_shock,zTS31D1_safety_day1_shock,zTS32D1_safety_day1_shock];
all_safety_day2_shock=[zTS21D1_safety_day2_shock,zTS22D1_safety_day2_shock,zTS23D1_safety_day2_shock,zTS31D1_safety_day2_shock,zTS32D1_safety_day2_shock];
all_safety_day3_shock=[zTS21D1_safety_day3_shock,zTS22D1_safety_day3_shock,zTS23D1_safety_day3_shock,zTS31D1_safety_day3_shock,zTS32D1_safety_day3_shock];

% tone infusions
all_before_vehicle1_tone=[zTS21D1_tone_vehicle1_b;zTS22D1_tone_vehicle1_b;zTS23D1_tone_vehicle1_b;zTS31D1_tone_vehicle1_b;zTS32D1_tone_vehicle1_b];
all_after_DAant_tone=[zTS21D1_tone_DAant;zTS22D1_tone_DAant;zTS23D1_tone_DAant;zTS31D1_tone_DAant;zTS32D1_tone_DAant];
all_after_TTX_tone=[zTS21D1_tone_TTX;zTS22D1_tone_TTX;zTS23D1_tone_TTX;zTS31D1_tone_TTX;zTS32D1_tone_TTX];

% shock infusions
all_before_vehicle1_shock=[zTS21D1_shock_vehicle1_b,zTS22D1_shock_vehicle1_b,zTS23D1_shock_vehicle1_b,zTS31D1_shock_vehicle1_b,zTS32D1_shock_vehicle1_b];
all_after_DAant_shock=[zTS21D1_shock_DAant,zTS22D1_shock_DAant,zTS23D1_shock_DAant,zTS31D1_shock_DAant,zTS32D1_shock_DAant];
all_after_TTX_shock=[zTS21D1_shock_TTX,zTS22D1_shock_TTX,zTS23D1_shock_TTX,zTS31D1_shock_TTX,zTS32D1_shock_TTX];

%% do waveform analysis on traces

% vehicle vs DA antagonists
waveform_analyzer_DA(ToneTime,all_after_vehicle1_tone,all_after_DAant_tone);
title('Safety Tone Vehicle vs Dopamine antagonists')

% vehicle vs TTX 
waveform_analyzer_TTX(ToneTime,all_after_vehicle1_tone,all_after_TTX_tone);
title('Safety Tone Vehicle vs TTX')
%% wave form analysis on footshocks 

% vehicle vs DA antagonists
waveform_analyzer_shock_DA(ShockTime,all_after_vehicle1_shock,all_after_DAant_shock);
title('Shock Vehicle vs Dopamine antagonists')

% vehicle vs TTX 
waveform_analyzer_shock_TTX(ShockTime,all_after_vehicle1_shock,all_after_TTX_shock);
title('Shock Tone Vehicle vs TTX')

%% plot training data

% tones
ErrorBarPlot(ToneTime,all_safety_day1_tones);
title('TS D1 safety tone day 1');

ErrorBarPlot(ToneTime,all_safety_day2_tones);
title('TS D1 safety tone day 2');

ErrorBarPlot(ToneTime,all_safety_day3_tones);
title('TS D1 safety tone day 3');

% shocks
ShockErrorBarPlot(ShockTime,all_safety_day1_shock);
title('TS D1 safety shock day 1');

ShockErrorBarPlot(ShockTime,all_safety_day2_shock);
title('TS D1 safety shock day 2');

ShockErrorBarPlot(ShockTime,all_safety_day3_shock);
title('TS D1 safety shock day 3');
